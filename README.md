## Sil — Telegram бот статистики MLBB

Sil помогает хранить и анализировать киберспортивные данные (команды, игроки, турниры, матчи и герои) и выдаёт удобные отчёты в Telegram.

### Возможности
- `/help`, `/player_stats`, `/team_stats`, `/hero_stats` — подробные отчёты и hero pool/топ героев.
- Интерактивный выбор турниров и полный hero pool по запросу.
- Автоматические текстовые разборы от OpenAI на основе собранной статистики.
- Админ-команды `/add_team`, `/add_player`, `/add_match` для ведения базы.

### Технологии
- Python 3.12, [aiogram 3](https://docs.aiogram.dev/), SQLite (`sqlite3`).
- `python-dotenv` для конфигурации.
- `openai` для генерации аналитических текстов.

### Подготовка окружения
1. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
2. Создайте файл `.env` (образец уже лежит в репозитории) и задайте:
   ```
   BOT_TOKEN=telegram_bot_token_here
   OPENAI_API_KEY=openai_api_key_here
   DB_PATH=sil.db               # опционально, путь к SQLite
   ADMIN_IDS=123456789,987654321
   OPENAI_MODEL=gpt-4o-mini     # можно заменить на нужную модель
   ```
3. При первом запуске база `sil.db` будет создана автоматически (таблицы описаны в `src/db.py`).

### Запуск бота
```bash
python -m src.main
```
> Рекомендуется запускать из виртуального окружения. Перед продакшеном проверьте, что токены/ключи заданы и недоступны публично.

### Администрирование
- `/add_team` — пошагово собирает название, тег и регион (можно пропустить).
- `/add_player` — запрашивает ник, команду (название/тег) и роль (кнопками).
- `/add_match` — создаёт турнир (если надо), матч между командами и предлагает внести статистику игроков. Для статистики вводите строки вида `Kairi,Lancelot,5,1,8`.
- При добавлении игроков/героев система проверяет существование записей и автоматически создаёт героя, если его ещё нет.

### Структура проекта
```
src/
  main.py              # запуск aiogram
  config.py            # загрузка .env
  db.py                # подключение SQLite и миграции
  ai_client.py         # обёртка OpenAI
  handlers/            # Telegram handlers по командам
  services/            # доступ к данным/статистике
  utils/               # форматирование текстов
requirements.txt
.env                   # пример переменных
```

### Полезные заметки
- Для корректной генерации аналитических текстов убедитесь, что OpenAI API доступен из вашего окружения.
- Все кнопки с выбором турниров/hero pool закреплены за конкретным пользователем — нельзя нажать чужую кнопку в общем чате.
- Hero pool/топ герои сортируются по количеству игр, что упрощает анализ меты.
